<!DOCTYPE html>
<canvas id="background-canvas"></canvas>
<html>
<head>
    <title>Portfolio - Shane Webster</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {
            background-repeat: no-repeat;
            background-position: top left;
            background-attachment: fixed;
        }

        h1 {
            font-family: Arial, sans-serif;
            color: ghostwhite;
            margin: 0;
            padding: 0;
        }

        p {
            font-family: Georgia, serif;
            font-size: 14px;
            font-style: normal;
            font-weight: normal;
            color: ghostwhite;
            margin: 0;
            padding: 0;
        }

        #background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            z-index: -1;
            width: 100%;
            height: 100%;
        }

        .content {
            position: relative;
            z-index: 2;
        }

        label {
            position: relative;
            width: 120px;
            height: 45px;
            display: block;
            background: #d9d9d9;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: inset 0px 5px 15px rgba(0,0,0,0.3), inset 0px -5px 15px rgba(255,255,255,0.3);
        }

        label:after {
            content: '';
            position: absolute;
            height: 40px;
            width: 40px;
            background: #f2f2f2;
            border-radius: 25px;
            top: 2.5px;
            left: 2.5px;
            transition: 0.5s;
            box-shadow: 0 5px 10px rgba(0,0,0,0.2);
        }

        input:checked ~ label:after {
            left: 117.5px;
            transform: translateX(-100%);
            background: linear-gradient(180deg,#777,#3a3a3a);
        }

        input:checked ~ label {
            background: #242424;
        }

        input {
            display: none;
        }

        .text-light-mode {
            color: black;
        }

    </style>
</head>

<body>

    <div class="content">

        <!-- Darkmode checkbox -->
        <input class="darkModeCheckbox" type="checkbox" id="dark-mode" checked> 
        <label for="dark-mode"></label>

        <h1>Text</h1>
        <p>Body Text</p>

    </div>

</body>

</html>

<script src="https://unpkg.com/trianglify@^4/dist/trianglify.bundle.js"></script>

<script>

    var canvas = document.getElementById("background-canvas");

    var intensity = 0.5;
    var intensityStep = 0.001;
    var animationInterval = 10; // Animation frame duration in milliseconds

    // Generate the initial pattern seed
    var seed = String(Math.random());

    //console.log(seed);

    var pattern = null;

    const canvasOpts = {
        scaling: 'auto',
        applyCssScaling: true
    }

    //Color palettes
    const dark = ['#222253', '#28345A', '#36616C', '#222253'];
    const light = ['#f7fcf0', '#e0f3db', '#ccebc5', '#a8ddb5', '#7bccc4', '#4eb3d3', '#2b8cbe', '#0868ac', '#084081'];

    //Dark mode by default
    var colorPalette = dark;

    const darkCheckbox = document.querySelector('.darkModeCheckbox');
    const paragraphs = document.querySelectorAll('p');
    const headings = document.querySelectorAll('h1');

    //Listen for checkbox change - change trianglify color palette and text color
    darkCheckbox.addEventListener('change', (event) => {
        if (event.currentTarget.checked) {
            colorPalette = dark;

            paragraphs.forEach(function (p) {
                p.classList.remove('text-light-mode');
            });
            headings.forEach(function (h1) {
                h1.classList.remove('text-light-mode');
            });
        } else {
            colorPalette = light;

            paragraphs.forEach(function (p) {
                p.classList.add('text-light-mode');
            });
            headings.forEach(function (h1) {
                h1.classList.add('text-light-mode');
            });
        }
    })

    function generatePattern(seed, colorPalette, intensity) {
        return trianglify({
            seed: seed,
            width: window.innerWidth,
            height: window.innerHeight,
            cellSize: 120,
            variance: 0.75,
            xColors: colorPalette,
            yColors: 'match',
            palette: trianglify.colorbrewer,
            colorFunction: trianglify.colorFunctions.interpolateLinear(intensity),
            strokeWidth: 0,
        })
    }

    function animate() {
        // Update the variance value
        intensity += intensityStep;

        // Clamp the variance within a certain range
        if (intensity <= 0.25 || intensity >= 1.0) {
            intensityStep *= -1;
        }

        pattern = generatePattern(seed, colorPalette, intensity);
        pattern.toCanvas(canvas, canvasOpts);


        // Call animate function again after the specified interval
        setTimeout(animate, animationInterval);
    }

    animate();

</script>